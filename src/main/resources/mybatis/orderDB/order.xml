<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mycompany.backOfficeAPI.dao.orderDB.OrderDao">
	
	<select id="selectByOid" resultType="order" parameterType="String">
		SELECT o.member_id, o.order_id, o.order_date, os.content state, o.request, o.zip_code, o.address1, o.address2, o.tel, o.name, o.coupon_id
		FROM morder o, order_state os
		WHERE order_id = #{value} AND o.state = os.state
	</select>
	
	<select id="selectByOidMid" resultType="order" parameterType="Map">
		SELECT order_date, state, request, zip_code, address1, address2, tel, tel, name, coupon_id
		FROM morder
		WHERE order_id = #{orderId} AND member_id = #{memberId} 
	</select>
	
	<select id="selectByMid" resultType="order" parameterType="String">
		SELECT order_id, order_date, state
		FROM morder
		WHERE member_id=#{value}
		ORDER BY order_date DESC
	</select>
	
	<update id="updateState" parameterType="order">
		UPDATE morder
		SET state = #{state}
		WHERE order_id = #{orderId}
	</update>
	
	<select id="selectOrderList" resultType="orderInfo">
		SELECT o.order_id, o.order_date, o.member_id, o.order_state, od.total_product, od.state1, od.state2, od.state3, od.state4, od.state5, p.total_price, p.pay_type
		FROM order_view o, orderdetail_view od, payment_view p
		WHERE o.order_id = od.order_id 
		AND p.order_id = od.order_id
		ORDER BY order_date DESC
	</select>
</mapper>

